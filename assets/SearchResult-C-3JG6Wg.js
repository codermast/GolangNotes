import{u as Y,f as ae,g as te,h as z,i as le,P as se,t as re,j as oe,k as F,l as w,m as ne,n as B,p as t,q as ue,R as j,s as ie,v as ce,x as ve,C as he,y as ge,z as pe,A as de,B as ye,D as me,E as x,F as fe,G as be,H as He,I,J as _,K as Re}from"./app--hxjvxHr.js";const ke=["/","/golang/","/golang/core/","/golang/core/concurrent/Concurrent-security-race-conditions.html","/golang/core/concurrent/channel.html","/golang/core/concurrent/concurrent-model.html","/golang/core/concurrent/context.html","/golang/core/concurrent/goroutine.html","/golang/core/concurrent/memory-model.html","/golang/core/concurrent/","/golang/core/concurrent/select.html","/golang/core/concurrent/synchronization-primitives.html","/golang/core/basic/array-slice.html","/golang/core/basic/background-introdece.html","/golang/core/basic/environment-config.html","/golang/core/basic/error.html","/golang/core/basic/function.html","/golang/core/basic/generic.html","/golang/core/basic/interface.html","/golang/core/basic/logic-statement.html","/golang/core/basic/map.html","/golang/core/basic/operator-symbol.html","/golang/core/basic/pointer.html","/golang/core/basic/","/golang/core/basic/struct.html","/golang/core/basic/variable-datatype.html","/404.html"],Qe="SEARCH_PRO_QUERY_HISTORY",m=Y(Qe,[]),we=()=>{const{queryHistoryCount:l}=x,s=l>0;return{enabled:s,queryHistory:m,addQueryHistory:r=>{s&&(m.value=Array.from(new Set([r,...m.value.slice(0,l-1)])))},removeQueryHistory:r=>{m.value=[...m.value.slice(0,r),...m.value.slice(r+1)]}}},P=l=>ke[l.id]+("anchor"in l?`#${l.anchor}`:""),xe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:U}=x,f=Y(xe,[]),qe=()=>{const l=U>0;return{enabled:l,resultHistory:f,addResultHistory:s=>{if(l){const r={link:P(s),display:s.display};"header"in s&&(r.header=s.header),f.value=[r,...f.value.slice(0,U-1)]}},removeResultHistory:s=>{f.value=[...f.value.slice(0,s),...f.value.slice(s+1)]}}},Ce=l=>{const s=he(),r=z(),q=ge(),n=F(0),R=w(()=>n.value>0),p=pe([]);return de(()=>{const{search:d,terminate:C}=ye(),b=me(c=>{const H=c.join(" "),{searchFilter:S=g=>g,splitWord:D,suggestionsFilter:O,...y}=s.value;H?(n.value+=1,d(c.join(" "),r.value,y).then(g=>S(g,H,r.value,q.value)).then(g=>{n.value-=1,p.value=g}).catch(g=>{console.warn(g),n.value-=1,n.value||(p.value=[])})):p.value=[]},x.searchDelay-x.suggestDelay);B([l,r],([c])=>b(c),{immediate:!0}),fe(()=>{C()})}),{isSearching:R,results:p}};var De=ae({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:s}){const r=te(),q=z(),n=le(se),{enabled:R,addQueryHistory:p,queryHistory:d,removeQueryHistory:C}=we(),{enabled:b,resultHistory:c,addResultHistory:H,removeResultHistory:S}=qe(),D=R||b,O=re(l,"queries"),{results:y,isSearching:g}=Ce(O),o=oe({isQuery:!0,index:0}),v=F(0),h=F(0),T=w(()=>D&&(d.value.length>0||c.value.length>0)),L=w(()=>y.value.length>0),A=w(()=>y.value[v.value]||null),M=()=>{const{isQuery:e,index:a}=o;a===0?(o.isQuery=!e,o.index=e?c.value.length-1:d.value.length-1):o.index=a-1},G=()=>{const{isQuery:e,index:a}=o;a===(e?d.value.length-1:c.value.length-1)?(o.isQuery=!e,o.index=0):o.index=a+1},J=()=>{v.value=v.value>0?v.value-1:y.value.length-1,h.value=A.value.contents.length-1},K=()=>{v.value=v.value<y.value.length-1?v.value+1:0,h.value=0},V=()=>{h.value<A.value.contents.length-1?h.value+=1:K()},N=()=>{h.value>0?h.value-=1:J()},E=e=>e.map(a=>Re(a)?a:t(a[0],a[1])),W=e=>{if(e.type==="customField"){const a=be[e.index]||"$content",[u,Q=""]=He(a)?a[q.value].split("$content"):a.split("$content");return e.display.map(i=>t("div",E([u,...i,Q])))}return e.display.map(a=>t("div",E(a)))},k=()=>{v.value=0,h.value=0,s("updateQuery",""),s("close")},X=()=>R?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},n.value.queryHistory),d.value.map((e,a)=>t("div",{class:["search-pro-result-item",{active:o.isQuery&&o.index===a}],onClick:()=>{s("updateQuery",e)}},[t(I,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:u=>{u.preventDefault(),u.stopPropagation(),C(a)}})]))])):null,Z=()=>b?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},n.value.resultHistory),c.value.map((e,a)=>t(j,{to:e.link,class:["search-pro-result-item",{active:!o.isQuery&&o.index===a}],onClick:()=>{k()}},()=>[t(I,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(u=>E(u)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:_,onClick:u=>{u.preventDefault(),u.stopPropagation(),S(a)}})]))])):null;return ne("keydown",e=>{if(l.isFocusing){if(L.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const a=A.value.contents[h.value];p(l.queries.join(" ")),H(a),r.push(P(a)),k()}}else if(b){if(e.key==="ArrowUp")M();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:a}=o;o.isQuery?(s("updateQuery",d.value[a]),e.preventDefault()):(r.push(c.value[a].link),k())}}}}),B([v,h],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!L.value:!T.value}],id:"search-pro-results"},l.queries.length?g.value?t(ue,{hint:n.value.searching}):L.value?t("ul",{class:"search-pro-result-list"},y.value.map(({title:e,contents:a},u)=>{const Q=v.value===u;return t("li",{class:["search-pro-result-list-item",{active:Q}]},[t("div",{class:"search-pro-result-title"},e||n.value.defaultTitle),a.map((i,ee)=>{const $=Q&&h.value===ee;return t(j,{to:P(i),class:["search-pro-result-item",{active:$,"aria-selected":$}],onClick:()=>{p(l.queries.join(" ")),H(i),k()}},()=>[i.type==="text"?null:t(i.type==="title"?ie:i.type==="heading"?ce:ve,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[i.type==="text"&&i.header?t("div",{class:"content-header"},i.header):null,t("div",W(i))])])})])})):n.value.emptyResult:D?T.value?[X(),Z()]:n.value.emptyHistory:n.value.emptyResult)}});export{De as default};
