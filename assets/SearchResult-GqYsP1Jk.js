import{u as Y,f as ae,g as te,h as z,i as le,P as re,t as se,j as ne,k as _,l as x,m as oe,n as B,p as t,q as ie,R as T,s as ue,v as ce,x as ge,C as me,y as de,z as he,A as ye,B as ve,D as pe,E as Q,F as be,G as fe,H as we,I as $,J as I,K as He}from"./app-Cui-RyAd.js";const Re=["/","/golang/","/golang/community/","/golang/core/","/golang/community/open-library/","/golang/community/open-library/golang.org-x-crypto-ssh.html","/golang/community/standard-library/","/golang/community/standard-library/bufio.html","/golang/community/standard-library/container.html","/golang/community/standard-library/crypto.html","/golang/community/standard-library/encoding_csv.html","/golang/community/standard-library/encoding_json.html","/golang/community/standard-library/encoding_xml.html","/golang/community/standard-library/flag.html","/golang/community/standard-library/fmt.html","/golang/community/standard-library/http.html","/golang/community/standard-library/io.html","/golang/community/standard-library/log.html","/golang/community/standard-library/math.html","/golang/community/standard-library/net.html","/golang/community/standard-library/os.html","/golang/community/standard-library/sort.html","/golang/community/standard-library/strconv.html","/golang/community/standard-library/time.html","/golang/core/basic/array-slice.html","/golang/core/basic/background-introdece.html","/golang/core/basic/environment-config.html","/golang/core/basic/error.html","/golang/core/basic/function.html","/golang/core/basic/generic.html","/golang/core/basic/interface.html","/golang/core/basic/logic-statement.html","/golang/core/basic/map.html","/golang/core/basic/operator-symbol.html","/golang/core/basic/pointer.html","/golang/core/basic/","/golang/core/basic/struct.html","/golang/core/basic/variable-datatype.html","/golang/core/concurrent/Concurrent-security-race-conditions.html","/golang/core/concurrent/channel.html","/golang/core/concurrent/concurrent-model.html","/golang/core/concurrent/context.html","/golang/core/concurrent/goroutine.html","/golang/core/concurrent/memory-model.html","/golang/core/concurrent/","/golang/core/concurrent/select.html","/golang/core/concurrent/synchronization-primitives.html","/golang/core/network/","/golang/web/gin/introduce.html","/golang/web/gin/middleware.html","/golang/web/gin/","/golang/web/gin/request-parameter.html","/golang/web/gin/response.html","/golang/web/gin/router.html","/golang/web/gin/session.html","/golang/web/gin/template-draw.html","/404.html","/golang/web/"],ke="SEARCH_PRO_QUERY_HISTORY",p=Y(ke,[]),xe=()=>{const{queryHistoryCount:l}=Q,r=l>0;return{enabled:r,queryHistory:p,addQueryHistory:s=>{r&&(p.value=Array.from(new Set([s,...p.value.slice(0,l-1)])))},removeQueryHistory:s=>{p.value=[...p.value.slice(0,s),...p.value.slice(s+1)]}}},F=l=>Re[l.id]+("anchor"in l?`#${l.anchor}`:""),Qe="SEARCH_PRO_RESULT_HISTORY",{resultHistoryCount:U}=Q,b=Y(Qe,[]),qe=()=>{const l=U>0;return{enabled:l,resultHistory:b,addResultHistory:r=>{if(l){const s={link:F(r),display:r.display};"header"in r&&(s.header=r.header),b.value=[s,...b.value.slice(0,U-1)]}},removeResultHistory:r=>{b.value=[...b.value.slice(0,r),...b.value.slice(r+1)]}}},Ce=l=>{const r=me(),s=z(),q=de(),o=_(0),H=x(()=>o.value>0),h=he([]);return ye(()=>{const{search:y,terminate:C}=ve(),f=pe(c=>{const w=c.join(" "),{searchFilter:S=d=>d,splitWord:D,suggestionsFilter:P,...v}=r.value;w?(o.value+=1,y(c.join(" "),s.value,v).then(d=>S(d,w,s.value,q.value)).then(d=>{o.value-=1,h.value=d}).catch(d=>{console.warn(d),o.value-=1,o.value||(h.value=[])})):h.value=[]},Q.searchDelay-Q.suggestDelay);B([l,s],([c])=>f(c),{immediate:!0}),be(()=>{C()})}),{isSearching:H,results:h}};var De=ae({name:"SearchResult",props:{queries:{type:Array,required:!0},isFocusing:Boolean},emits:["close","updateQuery"],setup(l,{emit:r}){const s=te(),q=z(),o=le(re),{enabled:H,addQueryHistory:h,queryHistory:y,removeQueryHistory:C}=xe(),{enabled:f,resultHistory:c,addResultHistory:w,removeResultHistory:S}=qe(),D=H||f,P=se(l,"queries"),{results:v,isSearching:d}=Ce(P),n=ne({isQuery:!0,index:0}),g=_(0),m=_(0),j=x(()=>D&&(y.value.length>0||c.value.length>0)),L=x(()=>v.value.length>0),A=x(()=>v.value[g.value]||null),M=()=>{const{isQuery:e,index:a}=n;a===0?(n.isQuery=!e,n.index=e?c.value.length-1:y.value.length-1):n.index=a-1},G=()=>{const{isQuery:e,index:a}=n;a===(e?y.value.length-1:c.value.length-1)?(n.isQuery=!e,n.index=0):n.index=a+1},J=()=>{g.value=g.value>0?g.value-1:v.value.length-1,m.value=A.value.contents.length-1},K=()=>{g.value=g.value<v.value.length-1?g.value+1:0,m.value=0},V=()=>{m.value<A.value.contents.length-1?m.value+=1:K()},N=()=>{m.value>0?m.value-=1:J()},E=e=>e.map(a=>He(a)?a:t(a[0],a[1])),W=e=>{if(e.type==="customField"){const a=fe[e.index]||"$content",[i,k=""]=we(a)?a[q.value].split("$content"):a.split("$content");return e.display.map(u=>t("div",E([i,...u,k])))}return e.display.map(a=>t("div",E(a)))},R=()=>{g.value=0,m.value=0,r("updateQuery",""),r("close")},X=()=>H?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.queryHistory),y.value.map((e,a)=>t("div",{class:["search-pro-result-item",{active:n.isQuery&&n.index===a}],onClick:()=>{r("updateQuery",e)}},[t($,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},e),t("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),C(a)}})]))])):null,Z=()=>f?t("ul",{class:"search-pro-result-list"},t("li",{class:"search-pro-result-list-item"},[t("div",{class:"search-pro-result-title"},o.value.resultHistory),c.value.map((e,a)=>t(T,{to:e.link,class:["search-pro-result-item",{active:!n.isQuery&&n.index===a}],onClick:()=>{R()}},()=>[t($,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[e.header?t("div",{class:"content-header"},e.header):null,t("div",e.display.map(i=>E(i)).flat())]),t("button",{class:"search-pro-remove-icon",innerHTML:I,onClick:i=>{i.preventDefault(),i.stopPropagation(),S(a)}})]))])):null;return oe("keydown",e=>{if(l.isFocusing){if(L.value){if(e.key==="ArrowUp")N();else if(e.key==="ArrowDown")V();else if(e.key==="Enter"){const a=A.value.contents[m.value];h(l.queries.join(" ")),w(a),s.push(F(a)),R()}}else if(f){if(e.key==="ArrowUp")M();else if(e.key==="ArrowDown")G();else if(e.key==="Enter"){const{index:a}=n;n.isQuery?(r("updateQuery",y.value[a]),e.preventDefault()):(s.push(c.value[a].link),R())}}}}),B([g,m],()=>{var e;(e=document.querySelector(".search-pro-result-list-item.active .search-pro-result-item.active"))==null||e.scrollIntoView(!1)},{flush:"post"}),()=>t("div",{class:["search-pro-result-wrapper",{empty:l.queries.length?!L.value:!j.value}],id:"search-pro-results"},l.queries.length?d.value?t(ie,{hint:o.value.searching}):L.value?t("ul",{class:"search-pro-result-list"},v.value.map(({title:e,contents:a},i)=>{const k=g.value===i;return t("li",{class:["search-pro-result-list-item",{active:k}]},[t("div",{class:"search-pro-result-title"},e||o.value.defaultTitle),a.map((u,ee)=>{const O=k&&m.value===ee;return t(T,{to:F(u),class:["search-pro-result-item",{active:O,"aria-selected":O}],onClick:()=>{h(l.queries.join(" ")),w(u),R()}},()=>[u.type==="text"?null:t(u.type==="title"?ue:u.type==="heading"?ce:ge,{class:"search-pro-result-type"}),t("div",{class:"search-pro-result-content"},[u.type==="text"&&u.header?t("div",{class:"content-header"},u.header):null,t("div",W(u))])])})])})):o.value.emptyResult:D?j.value?[X(),Z()]:o.value.emptyHistory:o.value.emptyResult)}});export{De as default};
